# Maintainer: Frederik Schwan <freswa at archlinux dot org>
# Contributor: Andrew Sun  <adsun701 at gmail dot com>
# Contributor: Kritias     <theodoridisgr at gmail dot com>
# Contributor: sudokode    <sudokode at gmail dot com>
# Contributor: Allan McRae <allan at archlinux dot org>

pkgname=libisl
pkgver=$(printf "$(cat /usr/lib/pkgconfig/isl.pc | grep Version: | cut -d' ' -f2)")
pkgrel=9999
pkgdesc='Library for manipulating sets and relations of integer points bounded by linear constraints'
arch=('any')
url='https://libisl.sourceforge.io'
license=('MIT')
depends=('gmp')
provides=('isl' 'libisl.so')
replaces=('isl')
options=(staticlibs)
source=("https://libisl.sourceforge.io/isl-${pkgver}.tar.xz")
b2sums=('SKIP')

build(){
  cd "${srcdir}"/${pkgname#lib}-${pkgver}
  ./configure --prefix=/usr
  make
}

check(){
  cd ${srcdir}/${pkgname#lib}-${pkgver}
  make check || true
}

package(){
  cd "${srcdir}"/${pkgname#lib}-${pkgver}

  make DESTDIR="${pkgdir}" install

  install -dm755 ${pkgdir}/usr/share/gdb/auto-load/usr/lib/
  mv ${pkgdir}/usr/lib/libisl.so.*-gdb.py ${pkgdir}/usr/share/gdb/auto-load/usr/lib/

  install -Dm644 LICENSE ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
}
